<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=350">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;600&display=swap" rel="stylesheet">
  <style>
    :root {
      /* NTFY.sh inspired color palette */
      --primary: #338574;
      --primary-dark: #2a6e60;
      --primary-light: #4a9d8c;

      /* Light theme */
      --bg-main: #f5f5f5;
      --bg-card: #ffffff;
      --bg-input: #ffffff;
      --text-primary: #1a1a1a;
      --text-secondary: #666666;
      --border-color: #e0e0e0;
      --border-focus: #338574;
      --shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    /* Dark theme - matching NTFY.sh web UI */
    body[data-theme="dark"] {
      --bg-main: #1B2124;
      --bg-card: #1B2124;
      --bg-input: #252b2a;
      --text-primary: #e8e8e8;
      --text-secondary: #9e9e9e;
      --border-color: #3a4240;
      --border-focus: #4a9d8c;
      --shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
    }

    /* Auto theme (system preference) */
    @media (prefers-color-scheme: dark) {
      body[data-theme="auto"] {
        --bg-main: #1B2124;
        --bg-card: #1B2124;
        --bg-input: #252b2a;
        --text-primary: #e8e8e8;
        --text-secondary: #9e9e9e;
        --border-color: #3a4240;
        --border-focus: #4a9d8c;
        --shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
      }
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Roboto', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      width: 350px;
      background-color: var(--bg-main);
      color: var(--text-primary);
    }

    /* Header */
    .header {
      background: linear-gradient(to right, #317f6e 0%, #57a49a 100%);
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.15);
      padding: 12px 16px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .header-title {
      color: white;
      font-size: 16px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .back-btn.visible {
      display: flex;
    }

    .header-actions {
      display: flex;
      gap: 8px;
    }

    .back-btn,
    .icon-btn {
      background: transparent;
      border: 1px solid transparent;
      border-radius: 6px;
      width: 32px;
      height: 32px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.2s;
      color: rgba(255, 255, 255, 0.9);
      /* font-size: 18px; removed in favor of SVG sizing */
      box-shadow: none;
    }

    .back-btn svg,
    .icon-btn svg {
      width: 24px;
      height: 24px;
      fill: currentColor;
    }

    .back-btn:hover,
    .icon-btn:hover:not(:disabled) {
      background: rgba(255, 255, 255, 0.15);
      transform: none;
      box-shadow: none;
      color: white;
    }

    .back-btn:active,
    .icon-btn:active:not(:disabled) {
      background: rgba(255, 255, 255, 0.25);
      transform: none;
    }

    .icon-btn:disabled {
      opacity: 0.4;
      cursor: not-allowed;
      background: transparent;
      color: white;
      box-shadow: none;
    }

    /* Highlighted settings button when not configured */
    .icon-btn.highlight {
      background: white;
      color: var(--primary);
      border-color: white;
      animation: pulse 1.5s ease-in-out infinite;
    }

    .icon-btn.highlight:hover {
      background: #f0f0f0;
    }

    /* Specific styles for back button visibility */
    .back-btn {
      display: none;
      /* font-size: 18px; */
    }

    .back-btn.visible {
      display: flex;
    }

    @keyframes pulse {

      0%,
      100% {
        box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.7);
      }

      50% {
        box-shadow: 0 0 0 6px rgba(255, 255, 255, 0);
      }
    }

    /* View containers */
    .view {
      display: none;
    }

    .view.active {
      display: block;
    }

    /* Main Content */
    .main-content {
      padding: 12px 16px;
      padding-bottom: 12px;
      min-height: auto;
    }

    /* Disabled/unconfigured state */
    .main-content.disabled {
      opacity: 0.4;
      pointer-events: none;
      user-select: none;
    }

    /* Form Elements */
    .form-group {
      margin-bottom: 8px;
    }

    .form-label {
      display: block;
      font-size: 11px;
      font-weight: 500;
      color: var(--text-secondary);
      margin-bottom: 4px;
      letter-spacing: 0.5px;
      transition: color 0.2s;
    }

    .form-group:focus-within .form-label {
      color: var(--primary);
    }

    .form-input,
    .form-select,
    .form-textarea {
      width: 100%;
      padding: 4px 0 10px 0;
      font-size: 14px;
      background-color: transparent;
      color: var(--text-primary);
      border: none;
      border-bottom: 1px solid var(--border-color);
      border-radius: 0;
      transition: border-color 0.2s;
      outline: none;
    }

    .form-input:hover,
    .form-select:hover,
    .form-textarea:hover {
      border-bottom-color: var(--border-focus);
    }

    .form-input:focus,
    .form-select:focus,
    .form-textarea:focus {
      border-bottom-color: var(--border-focus);
      border-bottom-width: 2px;
    }

    .form-input::placeholder,
    .form-textarea::placeholder,
    .topic-input-field::placeholder,
    .tag-input-field::placeholder {
      font-size: 11px;
      font-style: italic;
      color: var(--text-secondary);
    }

    .form-textarea {
      resize: vertical;
      min-height: 60px;
      font-family: inherit;
    }

    .form-select {
      display: none;
    }

    /* Custom Dropdown */
    .custom-dropdown {
      position: relative;
      width: 100%;
    }

    .custom-dropdown-selected {
      cursor: pointer;
      padding: 4px 28px 10px 0;
      border: none;
      border-bottom: 1px solid var(--border-color);
      background-color: transparent;
      display: flex;
      align-items: center;
      justify-content: space-between;
      color: var(--text-primary);
      font-size: 14px;
    }

    .custom-dropdown-selected:hover {
      border-bottom-color: var(--border-focus);
    }

    .custom-dropdown.open .custom-dropdown-selected {
      border-bottom-color: var(--border-focus);
      border-bottom-width: 2px;
    }

    .custom-dropdown-arrow {
      position: absolute;
      right: 4px;
      top: 50%;
      transform: translateY(-50%);
      pointer-events: none;
      transition: transform 0.2s;
    }

    .custom-dropdown.open .custom-dropdown-arrow {
      transform: translateY(-50%) rotate(180deg);
    }

    .custom-dropdown-arrow svg {
      width: 12px;
      height: 12px;
      fill: var(--text-secondary);
    }

    .custom-dropdown-options {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      border-top: none;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      z-index: 100;
      max-height: 200px;
      overflow-y: auto;
      display: none;
    }

    .custom-dropdown.open .custom-dropdown-options {
      display: block;
    }

    .custom-dropdown-option {
      padding: 10px 12px;
      cursor: pointer;
      font-size: 14px;
      color: var(--text-primary);
      transition: background-color 0.15s;
    }

    .custom-dropdown-option:hover {
      background-color: rgba(51, 133, 116, 0.1);
    }

    .custom-dropdown-option.selected {
      background-color: rgba(51, 133, 116, 0.15);
      color: var(--primary);
    }

    .form-hint {
      font-size: 11px;
      color: var(--text-secondary);
      margin-top: 4px;
      padding-bottom: 6px;
    }

    /* Topic Badges */
    /* Badges (Topics & Tags) */
    .topics-container,
    .tags-container {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 6px;
      padding: 4px 0 8px 0;
      background-color: transparent;
      border: none;
      border-bottom: 1px solid var(--border-color);
      border-radius: 0;
      min-height: 38px;
      transition: border-color 0.2s;
    }

    .topics-container:hover,
    .tags-container:hover {
      border-bottom-color: var(--border-focus);
    }

    .topics-container:focus-within,
    .tags-container:focus-within {
      border-bottom-color: var(--border-focus);
      border-bottom-width: 2px;
    }

    .topic-badge,
    .tag-badge {
      display: flex;
      align-items: center;
      background: linear-gradient(to right, #317f6e 0%, #57a49a 100%);
      color: white;
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 13px;
    }

    .topic-remove,
    .tag-remove {
      margin-left: 6px;
      cursor: pointer;
      opacity: 0.8;
      font-weight: bold;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 12px;
      height: 12px;
      font-size: 16px;
      line-height: 1;
    }

    .topic-remove:hover,
    .tag-remove:hover {
      opacity: 1;
    }

    .topic-input-field,
    .tag-input-field {
      border: none;
      outline: none;
      background: transparent;
      padding: 4px 0;
      flex: 1;
      min-width: 80px;
      font-size: 14px;
      color: var(--text-primary);
    }

    /* File Attachment */
    .file-section {
      margin-bottom: 8px;
    }

    .file-input {
      display: none;
    }

    .file-btn {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 8px 14px;
      font-size: 13px;
      font-weight: 500;
      color: var(--primary);
      background-color: transparent;
      border: 1px dashed var(--primary);
      border-radius: 20px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .file-btn:hover {
      background-color: rgba(51, 133, 116, 0.1);
    }

    /* Insert URL Button */
    .insert-url-btn {
      padding: 4px 10px;
      font-size: 10px;
      font-weight: 500;
      color: var(--primary);
      background: transparent;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      transition: background-color 0.2s;
    }

    .insert-url-btn:hover {
      background-color: rgba(51, 133, 116, 0.1);
    }

    .insert-url-btn:active {
      background-color: rgba(51, 133, 116, 0.2);
    }

    .file-preview {
      display: none;
      align-items: center;
      gap: 10px;
      padding: 10px 12px;
      background-color: var(--bg-input);
      border: 1px solid var(--border-color);
      border-radius: 8px;
    }

    .file-preview.visible {
      display: flex;
    }

    .file-icon {
      font-size: 20px;
    }

    .file-info {
      flex: 1;
      overflow: hidden;
    }

    .file-name {
      font-size: 13px;
      font-weight: 500;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .file-size {
      font-size: 11px;
      color: var(--text-secondary);
    }

    .file-remove {
      background: none;
      border: none;
      color: var(--text-secondary);
      cursor: pointer;
      font-size: 18px;
      padding: 4px;
      line-height: 1;
      transition: color 0.2s;
    }

    .file-remove:hover {
      color: #e53935;
    }

    /* Chips (Priority & Theme) */
    .chips {
      display: flex;
      gap: 4px;
      flex-wrap: wrap;
    }

    .chip {
      padding: 6px 8px;
      font-size: 12px;
      font-weight: 500;
      border: 1px solid var(--border-color);
      border-radius: 16px;
      background-color: var(--bg-input);
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.2s;
    }

    .chip:hover {
      border-color: var(--primary);
      color: var(--primary);
    }

    .chip.active {
      background: linear-gradient(to right, #317f6e 0%, #57a49a 100%);
      border-color: #317f6e;
      color: white;
    }

    /* Send Footer */
    /* Send Footer */
    .send-footer {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-top: 10px;
      padding-top: 8px;
    }

    .send-another-group {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .send-another-group input[type="checkbox"] {
      width: 14px;
      height: 14px;
      accent-color: var(--primary);
      cursor: pointer;
    }

    .send-another-group label {
      font-size: 13px;
      color: var(--text-secondary);
      cursor: pointer;
    }

    /* Send Button - Text style like ntfy.sh */
    .send-btn {
      padding: 8px 16px;
      font-size: 14px;
      font-weight: 500;
      color: var(--primary);
      background: transparent;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      transition: background-color 0.2s;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .send-btn:hover {
      background-color: rgba(51, 133, 116, 0.1);
    }

    .send-btn:active {
      background-color: rgba(51, 133, 116, 0.2);
    }

    .send-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .save-btn {
      width: 100%;
      padding: 12px 20px;
      font-size: 14px;
      font-weight: 600;
      color: white;
      background: linear-gradient(to right, #317f6e 0%, #57a49a 100%);
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
      margin-top: 4px;
    }

    .save-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(51, 133, 116, 0.3);
    }

    .save-btn:active {
      transform: translateY(0);
    }

    .save-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }

    /* Status Message */
    .status {
      text-align: center;
      font-size: 13px;
      padding: 8px 12px;
      border-radius: 6px;
      margin-top: 10px;
      margin-bottom: 4px;
      display: none;
    }

    .status.visible {
      display: block;
    }

    .status.success {
      background-color: rgba(51, 133, 116, 0.15);
      color: var(--primary);
    }

    .status.error {
      background-color: rgba(229, 57, 53, 0.15);
      color: #e53935;
    }

    .status.warning {
      background-color: rgba(255, 152, 0, 0.15);
      color: #f57c00;
    }

    /* Collapsible Advanced Options */
    .advanced-toggle {
      display: flex;
      align-items: center;
      gap: 6px;
      color: var(--text-secondary);
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      user-select: none;
      margin-bottom: 8px;
      margin-top: 12px;
    }

    .advanced-toggle:hover {
      color: var(--primary);
    }

    .advanced-toggle .arrow {
      transition: transform 0.2s;
    }

    .advanced-toggle.open .arrow {
      transform: rotate(90deg);
    }

    .advanced-options {
      display: none;
    }

    .advanced-options.visible {
      display: block;
    }

    /* Settings View */
    .section-title {
      font-size: 12px;
      font-weight: 600;
      margin: 12px 0 8px 0;
      color: var(--text-secondary);
    }

    .section-title:first-of-type {
      margin-top: 0;
    }

    .checkbox-group {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 14px;
    }

    .checkbox-group input[type="checkbox"] {
      width: 14px;
      height: 14px;
      accent-color: var(--primary);
      cursor: pointer;
    }

    .checkbox-group label {
      font-size: 11px;
      font-weight: 500;
      color: var(--text-secondary);
      cursor: pointer;
    }

    .divider {
      height: 1px;
      background-color: var(--border-color);
      margin: 10px 0;
    }

    /* Priority Icons */
    .p-icon {
      margin-right: 4px;
      font-weight: bold;
      font-size: 14px;
    }

    .chip.active .p-icon {
      color: inherit;
      /* White when active */
    }
  </style>
</head>

<body data-theme="auto">
  <!-- Header -->
  <div class="header">
    <div class="header-left">
      <div class="header-title">
        <img src="icons/icon48.png" alt="ntfy" style="width: 20px; height: 20px;">
        <span id="header-text">Send to ntfy</span>
      </div>
    </div>
    <div class="header-actions">
      <button class="back-btn" id="back-btn" title="Back">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
          <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z" />
        </svg>
      </button>
      <button class="icon-btn" id="open-url-btn" title="Open in ntfy">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
          <path
            d="M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z" />
        </svg>
      </button>
      <button class="icon-btn" id="settings-btn" title="Settings">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
          <path
            d="M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.49l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z" />
        </svg>
      </button>
    </div>
  </div>

  <!-- Main View -->
  <div class="view active" id="main-view">
    <div class="main-content" id="main-content">
      <!-- Topic Selection -->
      <div class="form-group">
        <label class="form-label">Topic</label>
        <div class="custom-dropdown" id="topic-dropdown">
          <div class="custom-dropdown-selected" id="topic-dropdown-selected">
            <span id="topic-dropdown-text">Select topic...</span>
          </div>
          <div class="custom-dropdown-arrow">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 12">
              <path d="M2 4l4 4 4-4" />
            </svg>
          </div>
          <div class="custom-dropdown-options" id="topic-dropdown-options"></div>
        </div>
        <select class="form-select" id="topic-select"></select>
      </div>

      <!-- Title (Optional) -->
      <div class="form-group">
        <label class="form-label" for="title-input">Title</label>
        <input type="text" class="form-input" id="title-input" placeholder="Notification title...">
      </div>

      <!-- Message -->
      <div class="form-group">
        <div style="display: flex; justify-content: space-between; align-items: center;">
          <label class="form-label" for="message-input">Message</label>
          <button type="button" id="insert-url-btn" class="insert-url-btn" title="Insert current page URL">
            üîó Insert URL
          </button>
        </div>
        <textarea class="form-textarea" id="message-input" placeholder="Your message..." rows="3"></textarea>
      </div>

      <!-- File Attachment -->
      <div class="file-section">
        <div class="file-input-wrapper">
          <input type="file" class="file-input" id="file-input">
          <button class="file-btn" id="file-btn">
            üìé Attach file
          </button>
        </div>
        <div class="file-preview" id="file-preview">
          <span class="file-icon">üìÑ</span>
          <div class="file-info">
            <div class="file-name" id="file-name"></div>
            <div class="file-size" id="file-size"></div>
          </div>
          <button class="file-remove" id="file-remove" title="Remove file">√ó</button>
        </div>
      </div>

      <!-- Advanced Options Toggle -->
      <div class="advanced-toggle" id="advanced-toggle">
        <span class="arrow">‚ñ∂</span>
        Advanced options
      </div>

      <!-- Advanced Options -->
      <div class="advanced-options" id="advanced-options">
        <!-- Priority -->
        <div class="form-group">
          <label class="form-label">Priority</label>
          <div class="chips" id="priority-chips">
            <button class="chip" data-priority="1"><span class="p-icon">‚áä</span>Min</button>
            <button class="chip" data-priority="2"><span class="p-icon">‚Üì</span>Low</button>
            <button class="chip active" data-priority="3">Default</button>
            <button class="chip" data-priority="4"><span class="p-icon">‚Üë</span>High</button>
            <button class="chip" data-priority="5"><span class="p-icon">‚áà</span>Urgent</button>
          </div>
        </div>

        <!-- Tags -->
        <div class="form-group">
          <label class="form-label">Tags</label>
          <div class="tags-container" id="tags-container">
            <input type="text" class="tag-input-field" id="new-tag-input" placeholder="Press enter to add tag">
          </div>
        </div>
      </div>

      <!-- Send Footer -->
      <div class="send-footer">
        <div class="send-another-group">
          <input type="checkbox" id="send-another-checkbox">
          <label for="send-another-checkbox">Send another</label>
        </div>
        <button class="send-btn" id="send-btn">Send</button>
      </div>

      <!-- Status Message -->
      <div class="status" id="status"></div>
    </div>
  </div>

  <!-- Settings View -->
  <div class="view" id="settings-view">
    <div class="main-content">




      <div class="form-group">
        <label class="form-label" for="url-input">Server URL</label>
        <input type="text" class="form-input" id="url-input" placeholder="https://ntfy.sh">
        <p class="form-hint">Base URL of your ntfy server</p>
      </div>

      <div class="form-group">
        <label class="form-label" for="token-input">Access Token (optional)</label>
        <input type="password" class="form-input" id="token-input" placeholder="tk_...">
        <p class="form-hint">For private topics or authenticated servers</p>
      </div>

      <div class="divider"></div>

      <div class="form-label">Topics</div>

      <div class="form-group">

        <div class="topics-container" id="topics-container">
          <input type="text" class="topic-input-field" id="new-topic-input" placeholder="Press enter to add topic">
        </div>
      </div>



      <div class="divider"></div>

      <div class="form-label">Appearance</div>
      <div class="form-group">
        <div class="chips" id="theme-chips">
          <button class="chip" data-theme="light">‚òÄÔ∏è Light</button>
          <button class="chip" data-theme="dark">üåô Dark</button>
          <button class="chip active" data-theme="auto">üîÑ Auto</button>
        </div>
      </div>

      <!-- Save button removed for auto-save -->
      <div class="status" id="settings-status"></div>
    </div>
  </div>

  <script src="popup.js"></script>
</body>

</html>